{"version":3,"file":"hooks.js","sources":["../src/state.js","../src/event.js","../src/effect.js"],"sourcesContent":["const states = new Map()\r\nlet index = 0\r\n\r\nconst useState = (initialState, onStateChange) => {\r\n    const stateIndex = index\r\n    states.set(index, initialState)\r\n    index++\r\n\r\n    const getState = () => {\r\n        return states.get(stateIndex)\r\n    }\r\n\r\n    const setState = (newState) => {\r\n        const oldState = states.get(stateIndex)\r\n        states.set(stateIndex, typeof newState === \"object\" ? Object.assign({}, newState) : newState)\r\n        if (typeof onStateChange === 'function') {\r\n            onStateChange(states.get(stateIndex), oldState)\r\n        }\r\n    }\r\n\r\n    return [getState, setState]\r\n}\r\n\r\nexport {\r\n    useState\r\n}\r\n","const useEventDefaults = {\r\n    effect: null,\r\n    event: \"load\",\r\n    target: globalThis,\r\n    one: false\r\n}\r\n\r\nconst useEvent = (/*useEventDefaults*/ arg) => {\r\n    let _target, _event, _effect, _one\r\n\r\n    if (typeof arg === \"function\") {\r\n        _target = globalThis\r\n        _event = \"load\"\r\n        _effect = arg\r\n        _one = true\r\n    } else if (typeof arg === \"object\" && arg === arg) {\r\n        _target = arg.target || globalThis\r\n        _event = arg.event || \"load\"\r\n        _effect = arg.effect || (() => {})\r\n        _one = arg.one || false\r\n    } else {\r\n        throw Error(`Invalid argument type!`)\r\n    }\r\n\r\n    if (typeof _target === \"string\") {\r\n        _target = document.querySelector(_target)\r\n    }\r\n\r\n    if (typeof _effect !== \"function\") {\r\n        throw Error(`Effect must be a function!`)\r\n    }\r\n\r\n    const listener = (e) => {\r\n        if (_one) {\r\n            _target.removeEventListener(_event, listener)\r\n        }\r\n        _effect(e)\r\n    }\r\n\r\n    return _target.addEventListener(_event, listener);\r\n}\r\n\r\nexport {\r\n    useEvent\r\n}\r\n","const USE_EFFECT_EVENTS = {\r\n    LOAD: 'load',\r\n    VIEWPORT: 'viewport',\r\n    ATTRIBUTE: 'attribute',\r\n    CHILDREN: 'children',\r\n    DATA: 'data',\r\n}\r\n\r\nconst useEffectDefaults = {\r\n    effect: f => f,\r\n    target: globalThis,\r\n    event: 'load',\r\n    root: null\r\n}\r\n\r\nconst useEffect = ({effect, target, event, root} = useEffectDefaults) => {\r\n    let _target, _event = event.toLowerCase()\r\n\r\n    if (typeof effect !== \"function\") {\r\n        throw Error(`Effect must be a function!`)\r\n    }\r\n\r\n    if (!target) {\r\n        throw Error(`Please specify a target element!`)\r\n    }\r\n\r\n    if (event === USE_EFFECT_EVENTS.LOAD) {\r\n        _target = target;\r\n    } else {\r\n        if (typeof target === \"string\") {\r\n            _target = document.querySelector(target)\r\n        } else if (target instanceof HTMLElement) {\r\n            _target = target\r\n        } else {\r\n            throw Error(`Invalid target element!`)\r\n        }\r\n    }\r\n\r\n    if (_event === USE_EFFECT_EVENTS.LOAD) {\r\n        const el = document.querySelector(_target)\r\n        if (el !== null) {\r\n            effect(el)\r\n        } else {\r\n            const observer = new MutationObserver((mutations, observer) => {\r\n                const el = document.querySelector(_target)\r\n                if (el !== null) {\r\n                    effect(el)\r\n                    observer.disconnect()\r\n                }\r\n            })\r\n            observer.observe(document.body, {\r\n                childList: true,\r\n                subtree: true,\r\n            })\r\n        }\r\n    } else if (_event === USE_EFFECT_EVENTS.VIEWPORT) {\r\n        let _root = root === null ? null : typeof root === \"string\" ? document.querySelector(root) : root\r\n        const observerOptions = {\r\n            root: _root,\r\n            rootMargin: \"0px\",\r\n            threshold: 0.5\r\n        }\r\n        const observer = new IntersectionObserver((entries, observer)=>{\r\n            entries.forEach(entry => {\r\n                if (entry.isIntersecting) {\r\n                    effect(_target)\r\n                }\r\n            })\r\n        }, observerOptions)\r\n        observer.observe(_target)\r\n    } else if (_event === USE_EFFECT_EVENTS.ATTRIBUTE) {\r\n        const observer = new MutationObserver((mutations) => {\r\n            for (let mut of mutations) {\r\n                if (mut.target === _target && mut.type === 'attributes') {\r\n                    effect(_target, mut.attributeName, _target.getAttribute(mut.attributeName))\r\n                }\r\n            }\r\n        })\r\n        observer.observe(_target, {\r\n            attributes: true,\r\n        })\r\n    } else if (_event === USE_EFFECT_EVENTS.CHILDREN) {\r\n        const observer = new MutationObserver((mutations) => {\r\n            for (let mut of mutations) {\r\n                if (mut.target === _target && mut.type === 'childList') {\r\n                    effect(_target, mut.addedNodes, mut.removedNodes)\r\n                }\r\n            }\r\n        })\r\n        observer.observe(_target, {\r\n            childList: true,\r\n            subtree: true,\r\n        })\r\n    } else if (_event === USE_EFFECT_EVENTS.DATA) {\r\n        const observer = new MutationObserver((mutations) => {\r\n            for (let mut of mutations) {\r\n                if (mut.target === _target && mut.type === 'characterData') {\r\n                    effect(_target, _target.textContent)\r\n                }\r\n            }\r\n        })\r\n        observer.observe(_target, {\r\n            characterData: true,\r\n        })\r\n    } else {\r\n\r\n    }\r\n}\r\n\r\nexport {\r\n    useEffect,\r\n    USE_EFFECT_EVENTS\r\n}"],"names":[],"mappings":"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"}